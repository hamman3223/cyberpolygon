# JuicyPotato/PrintSpoofer/RoguePotat

# JuicyPotato

### **–í–µ—Ä—Å–∏–∏ windows –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω—ã–µ –∞—Ç–∞–∫–µ:**

- Windows_10_Enterprise
- Windows_10_Pro
- Windows_7_Enterprise
- Windows_8.1_Enterprise
- Windows_Server_2008_R2_Enterprise
- Windows_Server_2012_Datacenter

### **–°—É—Ç—å –∞—Ç–∞–∫–∏:**

–£—è–∑–∫–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Å–µ—Ä–≤–∏—Å —É—á–µ—Ç–∫–∞–º (COM —É—á–µ—Ç–∫–∞–º) –≤—ã–¥–∞—é—Ç—Å—è —Ñ–ª–∞–≥–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π  **SeImpornatePrivilege** –∏–ª–∏ **SeAssignPrimaryTokenPrivilege**

–¢–∞–∫–∏–µ COM —É—á–µ—Ç–∫–∏ –µ—Å—Ç—å —É —Ç–∞–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∫–∞–∫ IIS –∏–ª–∏ SQL —Å–µ—Ä–≤–∏—Å—ã.

### –£—Å–ª–æ–≤–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ç–∞–∫–∏:

1. –Æ–∑–µ—Ä –∞–∫–∫–∞—É–Ω—Ç –∏–º–µ–µ—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ **SeImpersonatePrivilege** –∏–ª–∏ **SeAssignPrimaryTokenPrivilege**
2. COM —Å–µ—Ä–≤–µ—Ä —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º CLSID (Class ID - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏–ª–æ–∂—É—Ö–∏/—Å–µ—Ä–≤–∏—Å–∞ –≤ –≤–∏–Ω–¥–µ)
3. –ü–æ—Ä—Ç –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ –ø–æ–¥ COM —Å–µ—Ä–≤–µ—Ä–∞
4. –ê–¥—Ä–µ—Å –∞—Ç–∞–∫—É—é—â–µ–≥–æ
5. Netcat –∏–ª–∏ –≥–æ—Ç–æ–≤—ã–π —Ä–µ–≤–µ—Ä—Å —à–µ–ª –∏–∑ msfvenom‚Äô–∞

<aside>
üí° COM —Å–µ—Ä–≤–µ—Ä –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (EXE –∏–ª–∏ DLL) –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ä—è–¥ COM –æ–±—ä–µ–∫—Ç–æ–≤. (COM –æ–±—ä–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ API-–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ Windows (Windows shell, ActiveX, COM+ –∏ –¥—Ä—É–≥–∞—è —à–µ–ª—É—Ö–∞)

COM —Å–µ—Ä–≤–µ—Ä–∞ –∏–º–µ—é—Ç –∑–∞–ø–∏—Å–∏ –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ, –∞ —Ç–∞–∫–∂–µ CLSID –∏ APPID

</aside>

### –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã:

- **HTB (—Ç–∞—á–∫–∏ Bounty, Jeeves –∏ Conceal)**
- [https://medium.com/r3d-buck3t/impersonating-privileges-with-juicy-potato-e5896b20d505](https://medium.com/r3d-buck3t/impersonating-privileges-with-juicy-potato-e5896b20d505)

# PrintSpoofer

### **–í–µ—Ä—Å–∏–∏ windows –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω—ã–µ –∞—Ç–∞–∫–µ:**

1. Windows 10
2. Server 2016/2019

### –°—É—Ç—å –∞—Ç–∞–∫–∏:

–£—è–∑–∫–∞ —Ç–∞–∫–∂–µ —ç–∫—Å–ø–ª–æ–π—Ç–∏—Ç **SeImpersonatePrivelege** –∏ –≤–¥–æ–±–∞–≤–æ–∫ **SeAssignPrimaryTokenPrivilege**.

### –£—Å–ª–æ–≤–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

–ü–æ —Å—É—Ç–∏ —Ç–∞–∫–∏–µ –∂–µ –∫–∞–∫ –∏ —É JuicyPotato

### –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã:

- –û–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–ª–æ–π—Ç–∞ ([https://itm4n.github.io/printspoofer-abusing-impersonate-privileges/](https://itm4n.github.io/printspoofer-abusing-impersonate-privileges/))
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ ([https://github.com/itm4n/PrintSpoofer/blob/master/demo.gif](https://github.com/itm4n/PrintSpoofer/blob/master/demo.gif))

# RoguePotato

### –í–µ—Ä—Å–∏–∏ windows –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω—ã–µ –∞—Ç–∞–∫–µ:

- Windows 10 1809 +

### –°—É—Ç—å –∞—Ç–∞–∫–∏

–£—è–∑–∫–∞ —ç–∫—Å–ø–ª–æ–π—Ç–∏—Ç —Ñ–ª–∞–≥ permisions‚Äô–æ–≤ **SeAssignPrimaryTokenPrivilege**

### **–£—Å–ª–æ–≤–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

–¢—è–∂–µ–ª—ã–π —Å–ª—É—á–∞–π, —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ RPC Server‚Ä¶ –ù—É–∂–Ω–æ –≤–¥–∞–≤–∞—Ç—å—Å—è –≤ –≥–ª—É–±–æ–∫–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —ç–∫—Å–ø–ª–æ–π—Ç. –î—É–º–∞—é —Ç–∞–∫–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Å–ª—É—á–∞—è –Ω–µ –±—É–¥–µ—Ç –Ω–∞ –∫–∏–±–µ—Ä–ø–æ–ª–∏–≥–æ–Ω–µ

### –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã:

- –í —Ö–æ–¥–µ —Ä–µ—à–µ–Ω–∏—è –ª–∞–±—ã –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –∫–µ–π—Å RoguePotato ([https://0xdf.gitlab.io/2021/04/10/htb-apt.html](https://0xdf.gitlab.io/2021/04/10/htb-apt.html))